<template>
	<div class="slds-m-around_small"
		 style="height: 600px;">

		<!-- SPINNER -->
		<c-ef-spinner show={showSpinner}></c-ef-spinner>
		<!-- SPINNER -->

		<template lwc:if={readyToRender}>

			<table class="exTable">
				<!-- Letter header -->
				<tr>
					<template for:each={openedSheet.letterHeaders} for:item="letterObject">
						<td key={letterObject} style={letterObject.s} class="excelHeader">
							<div>{letterObject.letter}</div>
						</td>
					</template>
				</tr>
				<template for:each={openedSheet.rows} for:item="row">
					<tr key={row}>
						<!-- LEFT EXCEL HEADER -->
						<td class="excelHeader">
							<div>{row.numberHeader.number}</div>
						</td>
						<!-- LEFT EXCEL HEADER -->

						<template for:each={row.cells} for:item="cell">
							<td key={cell.idx}>
								<div style={cell.style}>{cell.value}</div>
							</td>
						</template>

					</tr>
				</template>
				<!-- Letter header -->
			</table>

			<lightning-button-group>
				<template for:each={tabs} for:item="tab">
					<lightning-button key={tab.value} label={tab.label} class={tab.class} ondblclick={showSheetSetup}
									  title="Double Click to Setup"
									  onclick={changeSheet}
									  value={tab.value}></lightning-button>
				</template>
				<lightning-button label='Add' icon-name="utility:add" class="tabButton"></lightning-button>
			</lightning-button-group>

		</template>

	</div>

	<template lwc:if={showSheetSetupDialog}>
		<c-ef-sheet-setup record-id={openedSheet.Id} template-id={recordId}></c-ef-sheet-setup>
	</template>


</template>